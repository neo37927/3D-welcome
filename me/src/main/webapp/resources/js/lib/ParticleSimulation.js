var ParticleSimulation=function(a,b,c){var d,e,f,g,h,i=b;c=c||{};var j=function(a){for(var b=3,c=new THREE.BufferGeometry,d=new Float32Array(a*a*b),e=0;a>e;e++)for(var f=0;a>f;f++){var g=e+f*a;d[b*g]=(e+.5)/a,d[b*g+1]=(f+.5)/a,d[b*g+2]=g/(a*a)}return c.addAttribute("position",new THREE.BufferAttribute(d,b)),c},k=function(){e=c.simMat||createShaderMaterial(SimShader),f=c.initMat||createShaderMaterial(SimInitShader),d=new SimulationRenderer(a,e,f,i),g=c.drawMat||createShaderMaterial(ParticleShader),g.blending=THREE.AdditiveBlending,g.transparent=!0,g.depthTest=!1,g.depthWrite=!1,d.registerUniform(g.uniforms.tPos);var b=j(i);h=new THREE.PointCloud(b,g),h.frustumCulled=!1};this.getParticleObject=function(){return h},k(),this.update=d.update};